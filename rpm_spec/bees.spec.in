%global VERSION 0.10

Name:           bees
Version:        %{VERSION}
Release:        1%{?dist}

Summary:        Best-Effort Extent-Same, a btrfs deduplication agent
License:        GPL-3.0-only
Group:          System/Filesystems
URL:            https://github.com/Zygo/bees
Source:         https://github.com/Zygo/bees/archive/refs/tags/v%{version}.tar.gz
BuildRequires:  gcc-c++
BuildRequires:  util-linux-core
BuildRequires:  systemd-devel
BuildRequires:  cmake
Requires:       btrfs-progs
Requires:       systemd
Requires:       util-linux

%description
bees is a block-oriented userspace deduplication agent designed for large btrfs
filesystems. It is an offline dedupe combined with an incremental data scan
capability to minimize time data spends on disk from write to dedupe.

%prep
%autosetup

%build
# Set the compiler flags using the %set_build_flags macro
%set_build_flags
%cmake -I../include -D_FILE_OFFSET_BITS=64 .
%cmake_build

%install
%cmake_install

%files
%license COPYING
%doc README.md
%{_bindir}/beesd
%{_libdir}/bees/libbees.so

%changelog
* Mon Feb 12 2024 Your Name <your.email@example.com> - 0.10-1
- Initial package

